name: Get changed folders

on:
  push:
    branches:
      - main

jobs:
  get-changed-folders:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v2
    - name: changed folders
      uses: Stockopedia/action-get-changed-files@v1
      id: get_changed
      with:
        github-token: ${{ secrets.GITHUB_TOKEN }}
        ignore: ".github"
        foldersOnly: true # to only include folders in the output
        format: json # either json, csv or newline
    - name: Echo
      run: |
        for val in ${{ steps.get_changed.outputs.changed }}; do
          echo "Value: $val"
        done
      # run: echo ${{ steps.get_changed.outputs.changed }}
#       $PROJECT_DIR = dbt/core/
# $SELECT = dbt run -s tag:aeropostale
# dbt deps --project-dir $PROJECT_DIR 
# dbt build --profiles-dir . --project-dir $PROJECT_DIR --select $SELECT
    # - name: Checkout code
    #   uses: actions/checkout@v2

    # - name: Get changed folders
    #   id: changed_folders
    #   run: |
    #     folders=$(git diff --name-only HEAD~1 HEAD | xargs -I{} dirname {} | sort -u)
    #     echo "::set-output name=folders::$folders"
      
    # - name: Use the output
    #   run: |
    #     echo "The following folders have been changed:"
    #     echo "${{ steps.changed_folders.outputs.folders }}"
